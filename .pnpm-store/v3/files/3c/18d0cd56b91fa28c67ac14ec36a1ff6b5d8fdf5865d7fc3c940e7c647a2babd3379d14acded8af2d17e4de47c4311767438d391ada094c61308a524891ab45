!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@tanstack/query-core"),require("react"),require("@tanstack/react-query")):"function"==typeof define&&define.amd?define(["exports","@tanstack/query-core","react","@tanstack/react-query"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ReactQueryPersistClient={},e.QueryCore,e.React,e.ReactQuery)}(this,(function(e,t,r,n){"use strict";function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var i=s(r);async function u({queryClient:e,persister:r,maxAge:n=864e5,buster:s="",hydrateOptions:i}){try{const u=await r.restoreClient();if(u)if(u.timestamp){const c=Date.now()-u.timestamp>n,a=u.buster!==s;c||a?r.removeClient():t.hydrate(e,u.clientState,i)}else r.removeClient()}catch(e){r.removeClient()}}async function c({queryClient:e,persister:r,buster:n="",dehydrateOptions:s}){const i={buster:n,timestamp:Date.now(),clientState:t.dehydrate(e,s)};await r.persistClient(i)}function a(e){const t=e.queryClient.getQueryCache().subscribe((()=>{c(e)})),r=e.queryClient.getMutationCache().subscribe((()=>{c(e)}));return()=>{t(),r()}}function o(e){let t,r=!1;return[()=>{r=!0,null==t||t()},u(e).then((()=>{r||(t=a(e))}))]}function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l.apply(this,arguments)}e.PersistQueryClientProvider=({client:e,children:t,persistOptions:r,onSuccess:s,...u})=>{const[c,a]=i.useState(!0),f=i.useRef({persistOptions:r,onSuccess:s});return i.useEffect((()=>{f.current={persistOptions:r,onSuccess:s}})),i.useEffect((()=>{let t=!1;a(!0);const[r,n]=o({...f.current.persistOptions,queryClient:e});return n.then((()=>{t||(null==f.current.onSuccess||f.current.onSuccess(),a(!1))})),()=>{t=!0,r()}}),[e]),i.createElement(n.QueryClientProvider,l({client:e},u),i.createElement(n.IsRestoringProvider,{value:c},t))},e.persistQueryClient=o,e.persistQueryClientRestore=u,e.persistQueryClientSave=c,e.persistQueryClientSubscribe=a,e.removeOldestQuery=({persistedClient:e})=>{const t=[...e.clientState.mutations],r=[...e.clientState.queries],n={...e,clientState:{mutations:t,queries:r}},s=[...r].sort(((e,t)=>e.state.dataUpdatedAt-t.state.dataUpdatedAt));if(s.length>0){const e=s.shift();return n.clientState.queries=r.filter((t=>t!==e)),n}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.production.js.map
