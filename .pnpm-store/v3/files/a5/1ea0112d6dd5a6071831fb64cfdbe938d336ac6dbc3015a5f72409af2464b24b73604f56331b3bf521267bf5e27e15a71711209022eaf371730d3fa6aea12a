{"version":3,"file":"index.js","sources":["../dist-src/version.js","../dist-src/webhooks.js","../dist-src/get-installation-octokit.js","../dist-src/each-installation.js","../dist-src/each-repository.js","../dist-src/middleware/node/on-unhandled-request-default.js","../dist-src/middleware/node/index.js","../dist-src/index.js"],"sourcesContent":["export const VERSION = \"13.0.5\";\n","import { createAppAuth } from \"@octokit/auth-app\";\nimport { createUnauthenticatedAuth } from \"@octokit/auth-unauthenticated\";\nimport { Webhooks } from \"@octokit/webhooks\";\nexport function webhooks(appOctokit, options\n// Explict return type for better debugability and performance,\n// see https://github.com/octokit/app.js/pull/201\n) {\n    return new Webhooks({\n        secret: options.secret,\n        transform: async (event) => {\n            if (!(\"installation\" in event.payload) ||\n                typeof event.payload.installation !== \"object\") {\n                const octokit = new appOctokit.constructor({\n                    authStrategy: createUnauthenticatedAuth,\n                    auth: {\n                        reason: `\"installation\" key missing in webhook event payload`,\n                    },\n                });\n                return {\n                    ...event,\n                    octokit: octokit,\n                };\n            }\n            const installationId = event.payload.installation.id;\n            const octokit = (await appOctokit.auth({\n                type: \"installation\",\n                installationId,\n                factory(auth) {\n                    return new auth.octokit.constructor({\n                        ...auth.octokitOptions,\n                        authStrategy: createAppAuth,\n                        ...{\n                            auth: {\n                                ...auth,\n                                installationId,\n                            },\n                        },\n                    });\n                },\n            }));\n            return {\n                ...event,\n                octokit: octokit,\n            };\n        },\n    });\n}\n","import { createAppAuth } from \"@octokit/auth-app\";\nexport async function getInstallationOctokit(app, installationId) {\n    return app.octokit.auth({\n        type: \"installation\",\n        installationId: installationId,\n        factory(auth) {\n            const options = {\n                ...auth.octokitOptions,\n                authStrategy: createAppAuth,\n                ...{ auth: { ...auth, installationId: installationId } },\n            };\n            return new auth.octokit.constructor(options);\n        },\n    });\n}\n","import { composePaginateRest } from \"@octokit/plugin-paginate-rest\";\nimport { getInstallationOctokit } from \"./get-installation-octokit\";\nexport function eachInstallationFactory(app) {\n    return Object.assign(eachInstallation.bind(null, app), {\n        iterator: eachInstallationIterator.bind(null, app),\n    });\n}\nexport async function eachInstallation(app, callback) {\n    const i = eachInstallationIterator(app)[Symbol.asyncIterator]();\n    let result = await i.next();\n    while (!result.done) {\n        await callback(result.value);\n        result = await i.next();\n    }\n}\nexport function eachInstallationIterator(app) {\n    return {\n        async *[Symbol.asyncIterator]() {\n            const iterator = composePaginateRest.iterator(app.octokit, \"GET /app/installations\");\n            for await (const { data: installations } of iterator) {\n                for (const installation of installations) {\n                    const installationOctokit = await getInstallationOctokit(app, installation.id);\n                    yield { octokit: installationOctokit, installation };\n                }\n            }\n        },\n    };\n}\n","import { composePaginateRest } from \"@octokit/plugin-paginate-rest\";\nexport function eachRepositoryFactory(app) {\n    return Object.assign(eachRepository.bind(null, app), {\n        iterator: eachRepositoryIterator.bind(null, app),\n    });\n}\nexport async function eachRepository(app, queryOrCallback, callback) {\n    const i = eachRepositoryIterator(app, callback ? queryOrCallback : undefined)[Symbol.asyncIterator]();\n    let result = await i.next();\n    while (!result.done) {\n        if (callback) {\n            await callback(result.value);\n        }\n        else {\n            await queryOrCallback(result.value);\n        }\n        result = await i.next();\n    }\n}\nfunction singleInstallationIterator(app, installationId) {\n    return {\n        async *[Symbol.asyncIterator]() {\n            yield {\n                octokit: await app.getInstallationOctokit(installationId),\n            };\n        },\n    };\n}\nexport function eachRepositoryIterator(app, query) {\n    return {\n        async *[Symbol.asyncIterator]() {\n            const iterator = query\n                ? singleInstallationIterator(app, query.installationId)\n                : app.eachInstallation.iterator();\n            for await (const { octokit } of iterator) {\n                const repositoriesIterator = composePaginateRest.iterator(octokit, \"GET /installation/repositories\");\n                for await (const { data: repositories } of repositoriesIterator) {\n                    for (const repository of repositories) {\n                        yield { octokit: octokit, repository };\n                    }\n                }\n            }\n        },\n    };\n}\n","export function onUnhandledRequestDefault(request, response) {\n    response.writeHead(404, {\n        \"content-type\": \"application/json\",\n    });\n    response.end(JSON.stringify({\n        error: `Unknown route: ${request.method} ${request.url}`,\n    }));\n}\n","import { createNodeMiddleware as oauthNodeMiddleware } from \"@octokit/oauth-app\";\nimport { createNodeMiddleware as webhooksNodeMiddleware } from \"@octokit/webhooks\";\nimport { onUnhandledRequestDefault } from \"./on-unhandled-request-default\";\nfunction noop() { }\nexport function createNodeMiddleware(app, options = {}) {\n    const log = Object.assign({\n        debug: noop,\n        info: noop,\n        warn: console.warn.bind(console),\n        error: console.error.bind(console),\n    }, options.log);\n    const optionsWithDefaults = {\n        onUnhandledRequest: onUnhandledRequestDefault,\n        pathPrefix: \"/api/github\",\n        ...options,\n        log,\n    };\n    const webhooksMiddleware = webhooksNodeMiddleware(app.webhooks, {\n        path: optionsWithDefaults.pathPrefix + \"/webhooks\",\n        log,\n        onUnhandledRequest: optionsWithDefaults.onUnhandledRequest,\n    });\n    const oauthMiddleware = oauthNodeMiddleware(app.oauth, {\n        pathPrefix: optionsWithDefaults.pathPrefix + \"/oauth\",\n        onUnhandledRequest: optionsWithDefaults.onUnhandledRequest,\n    });\n    return middleware.bind(null, optionsWithDefaults, {\n        webhooksMiddleware,\n        oauthMiddleware,\n    });\n}\nexport async function middleware(options, { webhooksMiddleware, oauthMiddleware }, request, response, next) {\n    const { pathname } = new URL(request.url, \"http://localhost\");\n    if (pathname === `${options.pathPrefix}/webhooks`) {\n        return webhooksMiddleware(request, response, next);\n    }\n    if (pathname.startsWith(`${options.pathPrefix}/oauth/`)) {\n        return oauthMiddleware(request, response, next);\n    }\n    const isExpressMiddleware = typeof next === \"function\";\n    if (isExpressMiddleware) {\n        // @ts-ignore `next` must be a function as we check two lines above\n        return next();\n    }\n    return options.onUnhandledRequest(request, response);\n}\n","import { Octokit as OctokitCore } from \"@octokit/core\";\nimport { createAppAuth } from \"@octokit/auth-app\";\nimport { OAuthApp } from \"@octokit/oauth-app\";\nimport { VERSION } from \"./version\";\nimport { webhooks } from \"./webhooks\";\nimport { eachInstallationFactory } from \"./each-installation\";\nimport { eachRepositoryFactory } from \"./each-repository\";\nimport { getInstallationOctokit } from \"./get-installation-octokit\";\nexport class App {\n    constructor(options) {\n        const Octokit = (options.Octokit ||\n            OctokitCore);\n        const authOptions = Object.assign({\n            appId: options.appId,\n            privateKey: options.privateKey,\n        }, options.oauth\n            ? {\n                clientId: options.oauth.clientId,\n                clientSecret: options.oauth.clientSecret,\n            }\n            : {});\n        this.octokit = new Octokit({\n            authStrategy: createAppAuth,\n            auth: authOptions,\n            log: options.log,\n        });\n        this.log = Object.assign({\n            debug: () => { },\n            info: () => { },\n            warn: console.warn.bind(console),\n            error: console.error.bind(console),\n        }, options.log);\n        // set app.webhooks depending on whether \"webhooks\" option has been passed\n        if (options.webhooks) {\n            // @ts-expect-error TODO: figure this out\n            this.webhooks = webhooks(this.octokit, options.webhooks);\n        }\n        else {\n            Object.defineProperty(this, \"webhooks\", {\n                get() {\n                    throw new Error(\"[@octokit/app] webhooks option not set\");\n                },\n            });\n        }\n        // set app.oauth depending on whether \"oauth\" option has been passed\n        if (options.oauth) {\n            this.oauth = new OAuthApp({\n                ...options.oauth,\n                clientType: \"github-app\",\n                Octokit,\n            });\n        }\n        else {\n            Object.defineProperty(this, \"oauth\", {\n                get() {\n                    throw new Error(\"[@octokit/app] oauth.clientId / oauth.clientSecret options are not set\");\n                },\n            });\n        }\n        this.getInstallationOctokit = getInstallationOctokit.bind(null, this);\n        this.eachInstallation = eachInstallationFactory(this);\n        this.eachRepository = eachRepositoryFactory(this);\n    }\n    static defaults(defaults) {\n        const AppWithDefaults = class extends this {\n            constructor(...args) {\n                super({\n                    ...defaults,\n                    ...args[0],\n                });\n            }\n        };\n        return AppWithDefaults;\n    }\n}\nApp.VERSION = VERSION;\nexport { createNodeMiddleware } from \"./middleware/node/index\";\n"],"names":["VERSION","webhooks","appOctokit","options","Webhooks","secret","transform","event","payload","installation","octokit","constructor","authStrategy","createUnauthenticatedAuth","auth","reason","installationId","id","type","factory","octokitOptions","createAppAuth","getInstallationOctokit","app","eachInstallationFactory","Object","assign","eachInstallation","bind","iterator","eachInstallationIterator","callback","i","Symbol","asyncIterator","result","next","done","value","composePaginateRest","data","installations","installationOctokit","eachRepositoryFactory","eachRepository","eachRepositoryIterator","queryOrCallback","undefined","singleInstallationIterator","query","repositoriesIterator","repositories","repository","onUnhandledRequestDefault","request","response","writeHead","end","JSON","stringify","error","method","url","noop","createNodeMiddleware","log","debug","info","warn","console","optionsWithDefaults","onUnhandledRequest","pathPrefix","webhooksMiddleware","webhooksNodeMiddleware","path","oauthMiddleware","oauthNodeMiddleware","oauth","middleware","pathname","URL","startsWith","isExpressMiddleware","App","Octokit","OctokitCore","authOptions","appId","privateKey","clientId","clientSecret","defineProperty","get","Error","OAuthApp","clientType","defaults","AppWithDefaults","args"],"mappings":"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"}